{
  "default": {
    "name": "${serviceName}",
    "log-driver": "gelf",
    "log-opt": ["gelf-address=udp://${logstash_ip}:12201", "tag=\"${serviceName}\""],
    "constraint": ["engine.labels.nodetype==worker"],
    "publish": ["mode=host,target=3040,published=3040,protocol=tcp"],
    "host": ["consul:172.17.0.1"],
    "env": [
      "SERVICE_NAME=${serviceName}",
      "SERVICE_3040_CHECK_HTTP=/api/health/check",
      "SERVICE_3040_CHECK_INTERVAL=15s",
      "SERVICE_3040_CHECK_TIMEOUT=3s",
      "RABBITMQ_USER=${SECRET_:env_RABBITMQUSER}",
      "RABBITMQ_PASS=${SECRET_:env_RABBITMQPASS}",
      "OXALIS_HOME=/run/secrets"
    ],
    "oc-consul-injection": {
      "redis/password": "${SECRET_:env_REDIS}",
      "mq/user": "${SECRET_:env_RABBITMQUSER}",
      "mq/password": "${SECRET_:env_RABBITMQPASS}",
      "a2a/host": "${SECRET_:env_A2AHOST}",
      "a2a/username": "${SECRET_:env_A2AUSERNAME}",
      "a2a/password": "${SECRET_:env_A2APASSWORD}"
    },
    "oc-secret-injection": {
      "oxalis-keystore.jks": {"type": "binary", "encoding": "base64", "value": "${SECRET_:env_PEPPOLKEYSTORE}"},
      "oxalis.conf": {"encoding": "base64", "value": "${OXALIS_:env_CONF}"}
    },
    "limit-cpu": "0.2",
    "limit-memory": "900M",
    "reserve-cpu": "0.1",
    "reserve-memory": "500M",
    "oc-service-user-create-override": "true"
  }
}
